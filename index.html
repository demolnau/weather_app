<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Document</title>
    <!-- Load icon library -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="style.css"/>
</head>
<body>
<!-- The form -->
<form class="example" action="#">
  <input type="text" id="search_text" placeholder="Search.." name="search">
  <button type="submit"><i class="fa fa-search"></i></button>
</form>
<div id="content">
    <p id="city"></p>
    <p id="region"></p>
    <p id="country"></p>
    <p id="lat/lon"></p>
    <div id="temp_choice">
        <p id="temperature"></p>
        <!-- Rounded switch -->
        <label class="switch">
          <label for="switch3" >Temperature in F</label>
          <input type="checkbox" id="switch3">
          <span class="slider round"></span>
          
        </label>
    </div>

    <p id="last_updated"></p>
    <p id="condition"></p>
</div>


  <script>
    let search_btn = document.querySelector('button[type="submit"]')
    let searchTerms = document.getElementById("search_text")
    let content =document.getElementById("content")
    let searchImage = document.createElement("img")
    let city= document.getElementById("city")
    let region =document.getElementById("region")
    let country =document.getElementById("country")
    let latLon = document.getElementById("lat/lon")
    let temperature = document.getElementById("temperature")
    let last_updated =document.getElementById("last_updated")
    let condition = document.getElementById("condition")
    /*
    let temp_switch = document.getElementById("switch")
    let temp_checkbox= document.createElement("input")
    temp_checkbox.setAttribute("type","checkbox")
    temp_switch.appendChild(temp_checkbox)
    let temp_span = document.createElement("span")
    temp_span.classList.add("slider")
    temp_span.classList.add("round")
    temp_switch.appendChild(temp_span)
*/    


    async function getInfo(searchThis){
      console.log("Term searched: "+ searchThis)
      try{
        const response = await fetch(`http://api.weatherapi.com/v1/current.json?key=3624a068aef7412f8f6204644232103&q=${searchThis}&aqi=no`, {mode: 'cors'})
        const weatherData = await response.json();
        console.log(weatherData)
        city.innerHTML= `City: ${weatherData.location.name}`
        region.innerHTML = `Region: ${weatherData.location.region}`
        country.innerHTML = `Country: ${weatherData.location.country}`
        latLon.innerHTML= "Latitude: " + weatherData.location.lat+ ", Longitutude: " + weatherData.location.lon;
        temperature.innerHTML = "Temperature in F: " + weatherData.current.temp_f + " Temperature in C: " + weatherData.current.temp_c;
        last_updated.innerHTML = "Last updated: "+ weatherData.current.last_updated;
        condition.innerHTML= `Weather conditions: ${weatherData.current.condition.text}`
        searchImage.src = weatherData.current.condition.icon
        
      }
      catch(error){
        console.log(error)
        content.innerHTML = "Weather API does not have data for that city."
      }

    }

    async function showResults(){
      content.appendChild(city)
      content.appendChild(region)
      content.appendChild(country)
      content.appendChild(latLon)
      content.appendChild(last_updated)
      content.appendChild(temperature)
      content.appendChild(condition)
      document.body.appendChild(content)
      document.body.appendChild(searchImage)
    }

    search_btn.onclick= function(){
        let searchThis = searchTerms.value
        searchTerms.value=""
        getInfo(searchThis)
        showResults()
    }
    
  

  </script>
</body>
</html>
